var closeErrorForm,closeDoneForm,closeButtonLink,requiredItem,userName,userSurname,userTel,userEmail,messageContent,valName,valSurname,valTel,valEmail,navMain=document.querySelector(".main-nav"),navButton=document.querySelector(".page-header__button"),reviewButton=document.querySelector(".review-form__button"),reviewForm=document.querySelector(".review-form"),errorForm=document.querySelector(".modal-form_error"),doneForm=document.querySelector(".modal-form_done"),requiredList=document.querySelectorAll("[required]"),isStorageSupport=!0,storageuserName="",storageuserSurname="",storageuserTel="",storageuserEmail="",storagemessageContent="";navMain.classList.remove("main-nav_nojs"),navMain.classList.toggle("main-nav_closed"),navButton.classList.remove("page-header__button_nojs"),navButton.addEventListener("click",function(e){navMain.classList.toggle("main-nav_closed"),navButton.classList.toggle("page-header__button_close")});try{storageuserName=localStorage.getItem("userName"),storageuserSurname=localStorage.getItem("userSurname"),storageuserTel=localStorage.getItem("userTel"),storageuserEmail=localStorage.getItem("userEmail"),storagemessageContent=localStorage.getItem("messageContent")}catch(e){isStorageSupport=!1}if(reviewButton){reviewForm.setAttribute("novalidate","novalidate"),closeErrorForm=errorForm.querySelector(".modal-form__button"),closeDoneForm=doneForm.querySelector(".modal-form__button"),userName=reviewForm.querySelector("[id=name]"),userSurname=reviewForm.querySelector("[id=surname]"),userTel=reviewForm.querySelector("[id=tel]"),userEmail=reviewForm.querySelector("[id=email]"),messageContent=reviewForm.querySelector("[id=content]"),reviewForm.addEventListener("submit",function(e){e.preventDefault(),userName.classList.remove("review-form__input_error"),userSurname.classList.remove("review-form__input_error"),userTel.classList.remove("review-form__input_error"),userEmail.classList.remove("review-form__input_error"),valName=checkName(userName.value),valSurname=checkName(userSurname.value),valTel=checkTel(userTel.value),valEmail=checkEmail(userEmail.value),valName&&valSurname&&valTel&&valEmail&&""!=messageContent.value?(isStorageSupport&&(localStorage.setItem("userName",userName.value),localStorage.setItem("userSurname",userSurname.value),localStorage.setItem("userTel",userTel.value),localStorage.setItem("userEmail",userEmail.value),localStorage.setItem("messageContent",messageContent.value)),doneForm.classList.remove("modal-show"),doneForm.offsetWidth=reviewForm.offsetWidth,doneForm.classList.add("modal-show")):(console.log("Заполните ваше имя, фамилию, телефон, обратный электронный адрес и текст отзыва"),errorForm.classList.remove("modal-show"),errorForm.offsetWidth=reviewForm.offsetWidth,errorForm.classList.add("modal-show"),valName||userName.classList.add("review-form__input_error"),valSurname||userSurname.classList.add("review-form__input_error"),valTel||userTel.classList.add("review-form__input_error"),valEmail||userEmail.classList.add("review-form__input_error"),""==messageContent.value&&messageContent.classList.add("review-form__input_error"))}),userName.onfocus=function(){userName.classList.remove("review-form__input_error")},userSurname.onfocus=function(){userSurname.classList.remove("review-form__input_error")},userTel.onfocus=function(){userTel.classList.remove("review-form__input_error")},userEmail.onfocus=function(){userEmail.classList.remove("review-form__input_error")},messageContent.onfocus=function(){messageContent.classList.remove("review-form__input_error")},closeErrorForm.addEventListener("click",function(e){errorForm.classList.contains("modal-show")&&(errorForm.classList.remove("modal-show"),setFocus())}),closeDoneForm.addEventListener("click",function(e){doneForm.classList.contains("modal-show")&&doneForm.classList.remove("modal-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),errorForm&&errorForm.classList.contains("modal-show")&&(errorForm.classList.remove("modal-show"),setFocus()),doneForm&&doneForm.classList.contains("modal-show")&&doneForm.classList.remove("modal-show"))});for(var i=0;i<requiredList.length;i++)(requiredItem=requiredList[i]).removeAttribute("required")}function setFocus(){valName?valSurname?valTel?valEmail?""==messageContent.value&&messageContent.focus():userEmail.focus():userTel.focus():userSurname.focus():userName.focus()}function checkEmail(e){return 0!=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)||(console.log("Введите корректный e-mail"),!1)}function checkName(e){return!!e.match(/^[A-Za-zА-Яа-я]+$/)}function checkTel(e){return!!e.match(/^[0-9]+$/)}